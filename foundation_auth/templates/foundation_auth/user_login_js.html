{% load i18n %}
<script>
    function ajax_api_login(username, password, success_callback, error_callback) {
        sign_in(
            username,
            password,
            function(json_result) {
                success_callback(json_result);
            },
            function(error_json_result) {
                error_callback(error_json_result);
            }
        ); // End Login
    }

    function ajax_login() {
        // Defensive Code: Name handling.
        if( $('#id_email').val() == "" ){
            alert("Missing Email");
            return;
        }
        if ( !is_email_valid( $('#id_email').val() ) ) {
            alert("Email not valid.");
            return;
        }
        if( $('#id_password').val() == "" ){
            alert("Missing Password");
            return;
        }

        ajax_api_login(
            $('#id_email').val(),
            $('#id_password').val(),
            function(login_json_result) {
                console.log(login_json_result); // Debugging purposes only.
                window.location = "{% url 'foundation_auth_user_launchpad' %}";
            },
            function(login_error_json_result) {
                var string = JSON.stringify( login_error_json_result );
                console.log(string);
                if (string.indexOf('username') > -1) {
                    alert("Wrong username or password.");
                } else if (string.indexOf('email') > -1) {
                    alert("Wrong email or password.");
                } else if (string.indexOf('disabled') > -1) {
                    alert("User account is disabled.");
                } else {
                    alert('Unknown Error:' + string);
                }
            }
        ); // end Login
    }
</script>
