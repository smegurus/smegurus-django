{% load staticfiles i18n compress foundation_public_tags %}
<!-- JS -->
{% compress js inline %}
<script>
    $(document).ready(function () {
        //---------------------------//
        // YEAR EXPENSE TEXT CHANGE  //
        //---------------------------//
        $('#id_m1').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m2').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m3').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m4').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m5').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m6').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m7').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m8').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m9').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m10').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m11').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m12').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m13').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m14').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m15').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m16').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m17').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m18').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m19').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m20').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m21').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m22').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m23').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m24').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m25').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m26').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m27').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m28').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m29').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m30').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m31').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m32').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m33').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m34').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m35').bind('input',function(){
            calculate_three_year_expenses();
        });
        $('#id_m36').bind('input',function(){
            calculate_three_year_expenses();
        });
    }); // end DOCUMENT START

    //--------------------------------//
    // CALCULATE ALL THE ROWS AT ONCE //
    //--------------------------------//
    function calculate_three_year_expenses() {
        calculate_annual_expense('#id_m1', '#id_m2', '#id_m3', '#id_m4', '#id_m5', '#id_m6', '#id_m7', '#id_m8', '#id_m9', '#id_m10', '#id_m11', '#id_m12', '#id_yr1_total');
        calculate_annual_expense('#id_m13', '#id_m14', '#id_m15', '#id_m16', '#id_m17', '#id_m18', '#id_m19', '#id_m20', '#id_m21', '#id_m22', '#id_m23', '#id_m24', '#id_yr2_total');
        calculate_annual_expense('#id_m25', '#id_m26', '#id_m27', '#id_m28', '#id_m29', '#id_m30', '#id_m31', '#id_m32', '#id_m33', '#id_m34', '#id_m35', '#id_m36', '#id_yr3_total');
    }

    //----------------------------//
    // CALCULATE INDIVIDUAL ITEMS //
    //----------------------------//

    /**
     *  Function will take all the year-N inputs and calculate the TOTAL COGS
     *  if all the values where valid integers. If not valid then a NaN will be
     *  generated. The key idea is the developer passes in the ID of the inputs
     *  and this function will reference them and make the UI change accordingly.
     */
    function calculate_annual_expense(m1_id, m2_id, m3_id, m4_id, m5_id, m6_id, m7_id, m8_id, m9_id, m10_id, m11_id, m12_id, total_id) {
        // The sum total of the materials, labour and overhead.
        var total = 0;

        // Fetch the User inputs.
        var year1 = parseFloat($(m1_id).val());
        var year2 = parseFloat($(m2_id).val());
        var year3 = parseFloat($(m3_id).val());
        var year4 = parseFloat($(m4_id).val());
        var year5 = parseFloat($(m5_id).val());
        var year6 = parseFloat($(m6_id).val());
        var year7 = parseFloat($(m7_id).val());
        var year8 = parseFloat($(m8_id).val());
        var year9 = parseFloat($(m9_id).val());
        var year10 = parseFloat($(m10_id).val());
        var year11 = parseFloat($(m11_id).val());
        var year12 = parseFloat($(m12_id).val());

        // Calculate the sum (if not NaN).
        total += year1;
        total += year2;
        total += year3;
        total += year4;
        total += year5;
        total += year6;
        total += year7;
        total += year8;
        total += year9;
        total += year10;
        total += year11;
        total += year12;

        // Update the UI
        $(total_id).val(total);
    }

    /**
     *  Function will load up the next URL after checking to see if the
     *  option was selected for this question.
     */
    function question_answer_protected_next(next_url) {
        // Fetch our inputs.
        //----------------------------------------
        var m1 = parseFloat($('#id_m1').val());
        var m2 = parseFloat($('#id_m2').val());
        var m3 = parseFloat($('#id_m3').val());
        var m4 = parseFloat($('#id_m4').val());
        var m5 = parseFloat($('#id_m5').val());
        var m6 = parseFloat($('#id_m6').val());
        var m7 = parseFloat($('#id_m7').val());
        var m8 = parseFloat($('#id_m8').val());
        var m9 = parseFloat($('#id_m9').val());
        var m10 = parseFloat($('#id_m10').val());
        var m11 = parseFloat($('#id_m11').val());
        var m12 = parseFloat($('#id_m12').val());
        var m13 = parseFloat($('#id_m13').val());
        var m14 = parseFloat($('#id_m14').val());
        var m15 = parseFloat($('#id_m15').val());
        var m16 = parseFloat($('#id_m16').val());
        var m17 = parseFloat($('#id_m17').val());
        var m18 = parseFloat($('#id_m18').val());
        var m19 = parseFloat($('#id_m19').val());
        var m20 = parseFloat($('#id_m20').val());
        var m21 = parseFloat($('#id_m21').val());
        var m22 = parseFloat($('#id_m22').val());
        var m23 = parseFloat($('#id_m23').val());
        var m24 = parseFloat($('#id_m24').val());
        var m25 = parseFloat($('#id_m25').val());
        var m26 = parseFloat($('#id_m26').val());
        var m27 = parseFloat($('#id_m27').val());
        var m28 = parseFloat($('#id_m28').val());
        var m29 = parseFloat($('#id_m29').val());
        var m30 = parseFloat($('#id_m30').val());
        var m31 = parseFloat($('#id_m31').val());
        var m32 = parseFloat($('#id_m32').val());
        var m33 = parseFloat($('#id_m33').val());
        var m34 = parseFloat($('#id_m34').val());
        var m35 = parseFloat($('#id_m35').val());
        var m36 = parseFloat($('#id_m36').val());
        var yr1_total = parseFloat($('#id_yr1_total').val());
        var yr2_total = parseFloat($('#id_yr2_total').val());
        var yr3_total = parseFloat($('#id_yr3_total').val());

        // VALIDATION.
        //----------------------------------------
        if (isNaN(m1)) {
            alert("{% trans 'Please fill in month 1.' %}");
            return;
        }
        if (isNaN(m2)) {
            alert("{% trans 'Please fill in month 2.' %}");
            return;
        }
        if (isNaN(m3)) {
            alert("{% trans 'Please fill in month 3.' %}");
            return;
        }
        if (isNaN(m4)) {
            alert("{% trans 'Please fill in month 4.' %}");
            return;
        }
        if (isNaN(m5)) {
            alert("{% trans 'Please fill in month 5.' %}");
            return;
        }
        if (isNaN(m6)) {
            alert("{% trans 'Please fill in month 6.' %}");
            return;
        }
        if (isNaN(m7)) {
            alert("{% trans 'Please fill in month 7.' %}");
            return;
        }
        if (isNaN(m8)) {
            alert("{% trans 'Please fill in month 8.' %}");
            return;
        }
        if (isNaN(m9)) {
            alert("{% trans 'Please fill in month 9.' %}");
            return;
        }
        if (isNaN(m10)) {
            alert("{% trans 'Please fill in month 10.' %}");
            return;
        }
        if (isNaN(m11)) {
            alert("{% trans 'Please fill in month 11.' %}");
            return;
        }
        if (isNaN(m12)) {
            alert("{% trans 'Please fill in month 12.' %}");
            return;
        }
        if (isNaN(m13)) {
            alert("{% trans 'Please fill in month 13.' %}");
            return;
        }
        if (isNaN(m14)) {
            alert("{% trans 'Please fill in month 14.' %}");
            return;
        }
        if (isNaN(m15)) {
            alert("{% trans 'Please fill in month 15.' %}");
            return;
        }
        if (isNaN(m16)) {
            alert("{% trans 'Please fill in month 16.' %}");
            return;
        }
        if (isNaN(m17)) {
            alert("{% trans 'Please fill in month 17.' %}");
            return;
        }
        if (isNaN(m18)) {
            alert("{% trans 'Please fill in month 18.' %}");
            return;
        }
        if (isNaN(m19)) {
            alert("{% trans 'Please fill in month 19.' %}");
            return;
        }
        if (isNaN(m20)) {
            alert("{% trans 'Please fill in month 20.' %}");
            return;
        }
        if (isNaN(m21)) {
            alert("{% trans 'Please fill in month 21.' %}");
            return;
        }
        if (isNaN(m22)) {
            alert("{% trans 'Please fill in month 22.' %}");
            return;
        }
        if (isNaN(m23)) {
            alert("{% trans 'Please fill in month 23.' %}");
            return;
        }
        if (isNaN(m24)) {
            alert("{% trans 'Please fill in month 24.' %}");
            return;
        }
        if (isNaN(m25)) {
            alert("{% trans 'Please fill in month 25.' %}");
            return;
        }
        if (isNaN(m26)) {
            alert("{% trans 'Please fill in month 26.' %}");
            return;
        }
        if (isNaN(m27)) {
            alert("{% trans 'Please fill in month 27.' %}");
            return;
        }
        if (isNaN(m28)) {
            alert("{% trans 'Please fill in month 28.' %}");
            return;
        }
        if (isNaN(m29)) {
            alert("{% trans 'Please fill in month 29.' %}");
            return;
        }
        if (isNaN(m30)) {
            alert("{% trans 'Please fill in month 30.' %}");
            return;
        }
        if (isNaN(m31)) {
            alert("{% trans 'Please fill in month 31.' %}");
            return;
        }
        if (isNaN(m32)) {
            alert("{% trans 'Please fill in month 32.' %}");
            return;
        }
        if (isNaN(m33)) {
            alert("{% trans 'Please fill in month 33.' %}");
            return;
        }
        if (isNaN(m34)) {
            alert("{% trans 'Please fill in month 34.' %}");
            return;
        }
        if (isNaN(m35)) {
            alert("{% trans 'Please fill in month 35.' %}");
            return;
        }
        if (isNaN(m36)) {
            alert("{% trans 'Please fill in month 36.' %}");
            return;
        }
        if (isNaN(yr1_total)) {
            alert("{% trans 'Please fill in all of year 1 with only numeric characters to ensure the final results for year 1 is not a dash or whitespace.' %}");
            return;
        }
        if (isNaN(yr2_total)) {
            alert("{% trans 'Please fill in all of year 2 with only numeric characters to ensure the final results for year 2 is not a dash or whitespace.' %}");
            return;
        }
        if (isNaN(yr3_total)) {
            alert("{% trans 'Please fill in all of year 3 with only numeric characters to ensure the final results for year 3 is not a dash or whitespace.' %}");
            return;
        }

        // CREATE OUR UPDATE URL.
        //----------------------------------------
        var arr = {
            'm1': m1,
            'm2': m2,
            'm3': m3,
            'm4': m4,
            'm5': m5,
            'm6': m6,
            'm7': m7,
            'm8': m8,
            'm9': m9,
            'm10': m10,
            'm11': m11,
            'm12': m12,
            'm13': m13,
            'm14': m14,
            'm15': m15,
            'm16': m16,
            'm17': m17,
            'm18': m18,
            'm19': m19,
            'm20': m20,
            'm21': m21,
            'm22': m22,
            'm23': m23,
            'm24': m24,
            'm25': m25,
            'm26': m26,
            'm27': m27,
            'm28': m28,
            'm29': m29,
            'm30': m30,
            'm31': m31,
            'm32': m32,
            'm33': m33,
            'm34': m34,
            'm35': m35,
            'm36': m36,
            'yr1_total': yr1_total,
            'yr2_total': yr2_total,
            'yr3_total': yr3_total
        };

        // Save to our database.
        //----------------------------------------
        ajax_do_chain(
            arr,
            function(json_result) {
                // LOAD UP THE NEXT SLIDE/QUESTION.
                window.location = next_url;
            }
        );
    }

    function ajax_do_chain(new_arr, callback) {
        // Fetch our pre-created (or previously-saved) "QuestionAnswer"
        // from our Database and convert it to JSON object.
        get_tenant_questionanswer(
            {{ answer.id }},
            function(question_answer) {

                // Set the JSON object with our picked value and stringify it.
                question_answer['content'] = JSON.stringify(new_arr);

                // Save our "QuestionAnswer" model object.
                set_tenant_questionanswer(
                    question_answer,
                    function(json_result) {
                        callback(json_result);
                    },
                    function(error_json_result) {
                        var string = JSON.stringify( error_json_result );
                        console.log(string);
                        alert(string);
                    }
                ); // end SET ANSWER
            },
            function(error_json_result) {
                var string = JSON.stringify( error_json_result );
                console.log(string);
                alert(string);
            }
        ); // end GET ANSWER
    };
</script>
{% endcompress %}
<!-- end JS -->
<!-- HTML -->
<fieldset>
    <legend>
        {{ node.order_num }}. {{ question.title|escape|safe }}
    </legend>
    <div class="form-group">
        <label class="col-sm-2 control-label"><!--{% trans 'Does this sound like you?' %}--></label>
        <div class="col-sm-12">
            <!-- BIZMULA EXPENSE TABLE YEAR 1 -->
            <div class="table-responsive">
               <table class="table table-striped table-bordered table-hover">
                  <thead>
                     <tr>
                        <th>{% trans 'Year' %}</th>
                        <th>{% trans 'Month 1' %}</th>
                        <th>{% trans 'Month 2' %}</th>
                        <th>{% trans 'Month 3' %}</th>
                        <th>{% trans 'Month 4' %}</th>
                        <th>{% trans 'Month 5' %}</th>
                        <th>{% trans 'Month 6' %}</th>
                        <th>{% trans 'Month 7' %}</th>
                        <th>{% trans 'Month 8' %}</th>
                        <th>{% trans 'Month 9' %}</th>
                        <th>{% trans 'Month 10' %}</th>
                        <th>{% trans 'Month 11' %}</th>
                        <th>{% trans 'Month 12' %}</th>
                        <th><b>{% trans 'TOTAL' %}</b></th>
                     </tr>
                  </thead>
                  <tbody>
                      <tr>
                         <td>{% trans '1' %}</td>
                         <td>
                             <input id="id_m1" type="number" class="form-control" placeholder="-" value="{{ picked.m1 }}">
                         </td>
                         <td>
                             <input id="id_m2" type="number" class="form-control" placeholder="-" value="{{ picked.m2 }}">
                         </td>
                         <td>
                             <input id="id_m3" type="number" class="form-control" placeholder="-" value="{{ picked.m3 }}">
                         </td>
                         <td>
                             <input id="id_m4" type="number" class="form-control" placeholder="-" value="{{ picked.m4 }}">
                         </td>
                         <td>
                             <input id="id_m5" type="number" class="form-control" placeholder="-" value="{{ picked.m5 }}">
                         </td>
                         <td>
                             <input id="id_m6" type="number" class="form-control" placeholder="-" value="{{ picked.m6 }}">
                         </td>
                         <td>
                             <input id="id_m7" type="number" class="form-control" placeholder="-" value="{{ picked.m7 }}">
                         </td>
                         <td>
                             <input id="id_m8" type="number" class="form-control" placeholder="-" value="{{ picked.m8 }}">
                         </td>
                         <td>
                             <input id="id_m9" type="number" class="form-control" placeholder="-" value="{{ picked.m9 }}">
                         </td>
                         <td>
                             <input id="id_m10" type="number" class="form-control" placeholder="-" value="{{ picked.m10 }}">
                         </td>
                         <td>
                             <input id="id_m11" type="number" class="form-control" placeholder="-" value="{{ picked.m11 }}">
                         </td>
                         <td>
                             <input id="id_m12" type="number" class="form-control" placeholder="-" value="{{ picked.m12 }}">
                         </td>
                         <td>
                             <input id="id_yr1_total" type="number" class="form-control" placeholder="-" value="{{ picked.yr1_total }}" readonly=true>
                         </td>
                      </tr>
                  </tbody>
               </table>
            </div>
            <!-- end BIZMULA EXPENSE TABLE YEAR 1 -->

            <br />
            <br />

            <!-- BIZMULA EXPENSE TABLE YEAR 2 -->
            <div class="table-responsive">
               <table class="table table-striped table-bordered table-hover">
                  <thead>
                     <tr>
                        <th>{% trans 'Year' %}</th>
                        <th>{% trans 'Month 13' %}</th>
                        <th>{% trans 'Month 14' %}</th>
                        <th>{% trans 'Month 15' %}</th>
                        <th>{% trans 'Month 16' %}</th>
                        <th>{% trans 'Month 17' %}</th>
                        <th>{% trans 'Month 18' %}</th>
                        <th>{% trans 'Month 19' %}</th>
                        <th>{% trans 'Month 20' %}</th>
                        <th>{% trans 'Month 21' %}</th>
                        <th>{% trans 'Month 22' %}</th>
                        <th>{% trans 'Month 23' %}</th>
                        <th>{% trans 'Month 24' %}</th>
                        <th><b>{% trans 'TOTAL' %}</b></th>
                     </tr>
                  </thead>
                  <tbody>
                      <tr>
                         <td>{% trans '2' %}</td>
                         <td>
                             <input id="id_m13" type="number" class="form-control" placeholder="-" value="{{ picked.m13 }}">
                         </td>
                         <td>
                             <input id="id_m14" type="number" class="form-control" placeholder="-" value="{{ picked.m14 }}">
                         </td>
                         <td>
                             <input id="id_m15" type="number" class="form-control" placeholder="-" value="{{ picked.m15 }}">
                         </td>
                         <td>
                             <input id="id_m16" type="number" class="form-control" placeholder="-" value="{{ picked.m16 }}">
                         </td>
                         <td>
                             <input id="id_m17" type="number" class="form-control" placeholder="-" value="{{ picked.m17 }}">
                         </td>
                         <td>
                             <input id="id_m18" type="number" class="form-control" placeholder="-" value="{{ picked.m18 }}">
                         </td>
                         <td>
                             <input id="id_m19" type="number" class="form-control" placeholder="-" value="{{ picked.m19 }}">
                         </td>
                         <td>
                             <input id="id_m20" type="number" class="form-control" placeholder="-" value="{{ picked.m20 }}">
                         </td>
                         <td>
                             <input id="id_m21" type="number" class="form-control" placeholder="-" value="{{ picked.m21 }}">
                         </td>
                         <td>
                             <input id="id_m22" type="number" class="form-control" placeholder="-" value="{{ picked.m22 }}">
                         </td>
                         <td>
                             <input id="id_m23" type="number" class="form-control" placeholder="-" value="{{ picked.m23 }}">
                         </td>
                         <td>
                             <input id="id_m24" type="number" class="form-control" placeholder="-" value="{{ picked.m24 }}">
                         </td>
                         <td>
                             <input id="id_yr2_total" type="number" class="form-control" placeholder="-" value="{{ picked.yr2_total }}" readonly=true>
                         </td>
                      </tr>
                  </tbody>
               </table>
            </div>
            <!-- end BIZMULA EXPENSE TABLE YEAR 2 -->

            <br />
            <br />

            <!-- BIZMULA EXPENSE TABLE YEAR 3 -->
            <div class="table-responsive">
               <table class="table table-striped table-bordered table-hover">
                  <thead>
                     <tr>
                        <th>{% trans 'Year' %}</th>
                        <th>{% trans 'Month 25' %}</th>
                        <th>{% trans 'Month 26' %}</th>
                        <th>{% trans 'Month 27' %}</th>
                        <th>{% trans 'Month 28' %}</th>
                        <th>{% trans 'Month 29' %}</th>
                        <th>{% trans 'Month 30' %}</th>
                        <th>{% trans 'Month 31' %}</th>
                        <th>{% trans 'Month 32' %}</th>
                        <th>{% trans 'Month 33' %}</th>
                        <th>{% trans 'Month 34' %}</th>
                        <th>{% trans 'Month 35' %}</th>
                        <th>{% trans 'Month 36' %}</th>
                        <th><b>{% trans 'TOTAL' %}</b></th>
                     </tr>
                  </thead>
                  <tbody>
                      <tr>
                         <td>{% trans '3' %}</td>
                         <td>
                             <input id="id_m25" type="number" class="form-control" placeholder="-" value="{{ picked.m25 }}">
                         </td>
                         <td>
                             <input id="id_m26" type="number" class="form-control" placeholder="-" value="{{ picked.m26 }}">
                         </td>
                         <td>
                             <input id="id_m27" type="number" class="form-control" placeholder="-" value="{{ picked.m27 }}">
                         </td>
                         <td>
                             <input id="id_m28" type="number" class="form-control" placeholder="-" value="{{ picked.m28 }}">
                         </td>
                         <td>
                             <input id="id_m29" type="number" class="form-control" placeholder="-" value="{{ picked.m29 }}">
                         </td>
                         <td>
                             <input id="id_m30" type="number" class="form-control" placeholder="-" value="{{ picked.m30 }}">
                         </td>
                         <td>
                             <input id="id_m31" type="number" class="form-control" placeholder="-" value="{{ picked.m31 }}">
                         </td>
                         <td>
                             <input id="id_m32" type="number" class="form-control" placeholder="-" value="{{ picked.m32 }}">
                         </td>
                         <td>
                             <input id="id_m33" type="number" class="form-control" placeholder="-" value="{{ picked.m33 }}">
                         </td>
                         <td>
                             <input id="id_m34" type="number" class="form-control" placeholder="-" value="{{ picked.m34 }}">
                         </td>
                         <td>
                             <input id="id_m35" type="number" class="form-control" placeholder="-" value="{{ picked.m35 }}">
                         </td>
                         <td>
                             <input id="id_m36" type="number" class="form-control" placeholder="-" value="{{ picked.m36 }}">
                         </td>
                         <td>
                             <input id="id_yr3_total" type="number" class="form-control" placeholder="-" value="{{ picked.yr3_total }}" readonly=true>
                         </td>
                      </tr>
                  </tbody>
               </table>
            </div>
            <!-- BIZMULA EXPENSE TABLE YEAR 3 -->
        </div>
    </div>
</fieldset>
<!-- end HTML -->
